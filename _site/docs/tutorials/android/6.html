<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  
    <title>SSIDとパスワードの変更 - website</title>

    
  

  <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" type="image/x-icon">

  <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="http://localhost:4000/assets/css/just-the-docs.css">
  <link rel="stylesheet" href="http://localhost:4000/assets/css/customstyles.css">
  

  
    <script type="text/javascript" src="http://localhost:4000/assets/js/vendor/lunr.min.js"></script>
  
  <script type="text/javascript" src="http://localhost:4000/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>SSIDとパスワードの変更 | website</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="SSIDとパスワードの変更" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/docs/tutorials/android/6.html" />
<meta property="og:url" content="http://localhost:4000/docs/tutorials/android/6.html" />
<meta property="og:site_name" content="website" />
<script type="application/ld+json">
{"@type":"WebPage","url":"http://localhost:4000/docs/tutorials/android/6.html","headline":"SSIDとパスワードの変更","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>

  <div class="page-wrap">
    <div class="side-bar">
      <a href="http://localhost:4000" class="site-title lh-tight">FlashAir Developers</a>
      <span class="fs-3"><button class="js-main-nav-trigger navigation-list-toggle btn btn-outline" type="button" data-text-toggle="Hide">Menu</button></span>
      <div class="navigation main-nav js-main-nav">
        <nav role="navigation" aria-label="Main navigation">
    <ul class="navigation-list">
      
      
        
      
        
      
        
          
            <li class="navigation-list-item">
              
              <a href="http://localhost:4000/docs/tutorials/android/1.html" class="navigation-list-link">Android向けFlashAirアプリ開発の概要</a>
            </li>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
            <li class="navigation-list-item">
              
              <a href="http://localhost:4000/docs/tutorials/android/2.html" class="navigation-list-link">コンテンツリストの取得</a>
            </li>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
            <li class="navigation-list-item">
              
              <a href="http://localhost:4000/docs/tutorials/android/3.html" class="navigation-list-link">コンテンツのダウンロード</a>
            </li>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
            <li class="navigation-list-item">
              
              <a href="http://localhost:4000/docs/tutorials/android/4.html" class="navigation-list-link">サムネイルの表示</a>
            </li>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
            <li class="navigation-list-item">
              
              <a href="http://localhost:4000/docs/tutorials/android/5.html" class="navigation-list-link">コンテンツの自動更新</a>
            </li>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
            <li class="navigation-list-item active">
              
              <a href="http://localhost:4000/docs/tutorials/android/6.html" class="navigation-list-link active">SSIDとパスワードの変更</a>
            </li>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
            <li class="navigation-list-item">
              
              <a href="http://localhost:4000/docs/tutorials/android/7.html" class="navigation-list-link">FlashAirへのアップロード</a>
            </li>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
            <li class="navigation-list-item">
              
              <a href="http://localhost:4000/docs/tutorials/android/8.html" class="navigation-list-link">フォトシェア</a>
            </li>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      

      <li>
        <br>
        <a href="/docs/tutorials/android">目次に戻る</a>
      </li>
    </ul>
  </nav>
      </div>
      <footer role="contentinfo" class="site-footer">
        <p class="text-small text-grey-dk-000 mb-0">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p>
      </footer>
    </div>
    <div class="main-content-wrap js-main-content" tabindex="0">
      <div class="page-header">
        <div class="main-content">
          
          <div class="search js-search">
            <div class="search-input-wrap">
              <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search website" aria-label="Search website" autocomplete="off">
              <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg>
            </div>
            <div class="js-search-results search-results-wrap"></div>
          </div>
          
          
        </div>
      </div>
      <div class="main-content">
        
          
            <nav class="breadcrumb-nav">
              <ol class="breadcrumb-nav-list">
                
                  <li class="breadcrumb-nav-list-item"><span>チュートリアル</span></li>
                  <li class="breadcrumb-nav-list-item"><span>Android向けチュートリアル</span></li>
                
                <li class="breadcrumb-nav-list-item"><span>SSIDとパスワードの変更</span></li>
              </ol>
            </nav>
          
        
        <div id="main-content" class="page-content" role="main">
          <h1 id="ssidとパスワードの変更">SSIDとパスワードの変更</h1>

<p>このチュートリアルではSSIDとパスワードの取得と更新方法について学びます。<br />
<a href="/docs/api/command.cgi">command.cgi</a> と
<a href="/docs/api/config.cgi">config.cgi</a> を使用します。</p>

<p>ここでは、SSIDとパスワードを取得し表示する画面、SSIDとパスワードを新しい内容で更新する画面の、２つの画面を持つアプリケーションとして作ってみましょう。</p>

<p>１つ目の画面はボタンを２つ用意します:</p>

<p><img src="/assets/images/tutorials/android_tutorial_06_1.png" alt="This image shows the first screen with only the two buttons" class="d-block" /></p>

<p>“Get” をクリック（タップ）すると、テキストフィールドに現在のSSIDとパスワードを表示することができます:</p>

<p><img src="/assets/images/tutorials/android_tutorial_06_2.png" alt="This image shows the get screen with SSID and password" class="d-block" /></p>

<p>“Set” をクリック（タップ）すると次の画面へ遷移し、 新しいSSIDとパスワードを設定することができます:</p>

<p><img src="/assets/images/tutorials/android_tutorial_06_3.png" alt="This image shows the set screen with empty text fields" class="d-block" /></p>

<p>アプリケーションを作成するために、次のファイルを作成します:</p>

<ul>
  <li><em>MainActivity.java</em></li>
  <li><em>activity_main.xml</em></li>
  <li><em>SetScreenActivity.java</em></li>
  <li><em>activity_set_screen.xml</em></li>
</ul>

<p><span class="badge label-red">重要:</span> Android application
は、デフォルトの状態ではインターネットにアクセスすることができません。<br />
そのため、設定ファイル
<em>AndroidManifest.xml</em> を変更し、権限を与える必要があります。<br />
パス:
<em>[Project_Folder]/AndroidManifest.xml</em>
<em>AndroidManifest.xml</em> に以下のコードを追加してください:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;uses-permission android:name="android.permission.INTERNET" /&gt;
</code></pre></div></div>

<p>ではまず、
<em>activity_main.xml</em> を記述して、レイアウトを決定します。<br />
このファイルは、layout フォルダに配置されています。<br />
パス:
<em>[Project_Folder]/res/layout/activity_main.xml</em></p>

<hr />
<h2 id="get-画面のレイアウト作成">Get 画面のレイアウト作成</h2>

<p><em>activity_main.xml</em> に以下のように記述してください:</p>

<h5 id="activity_mainxml"><em>activity_main.xml</em></h5>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nt">&lt;LinearLayout</span> <span class="na">xmlns:android=</span><span class="s">"http://schemas.android.com/apk/res/android"</span>
        <span class="na">xmlns:tools=</span><span class="s">"http://schemas.android.com/tools"</span>
        <span class="na">android:layout_width=</span><span class="s">"fill_parent"</span>
        <span class="na">android:layout_height=</span><span class="s">"match_parent"</span>
        <span class="na">android:gravity=</span><span class="s">"center_horizontal"</span>
        <span class="na">android:orientation=</span><span class="s">"vertical"</span>
        <span class="na">tools:context=</span><span class="s">".MainActivity"</span> <span class="nt">&gt;</span>

        <span class="nt">&lt;Button</span>
            <span class="na">android:id=</span><span class="s">"@+id/button1"</span>
            <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
            <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
            <span class="na">android:cacheColorHint=</span><span class="s">"#00000000"</span>
            <span class="na">android:text=</span><span class="s">"Get"</span>
            <span class="na">android:textColor=</span><span class="s">"@android:color/white"</span>
            <span class="na">android:textSize=</span><span class="s">"20sp"</span> <span class="nt">/&gt;</span>

        <span class="nt">&lt;Button</span>
            <span class="na">android:id=</span><span class="s">"@+id/button2"</span>
            <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
            <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
            <span class="na">android:cacheColorHint=</span><span class="s">"#00000000"</span>
            <span class="na">android:text=</span><span class="s">"Set"</span>
            <span class="na">android:textColor=</span><span class="s">"@android:color/white"</span>
            <span class="na">android:textSize=</span><span class="s">"20sp"</span> <span class="nt">/&gt;</span>

        <span class="nt">&lt;TextView</span>
            <span class="na">android:id=</span><span class="s">"@+id/SSIDlabelView"</span>
            <span class="na">android:layout_width=</span><span class="s">"wrap_content"</span>
            <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
            <span class="na">android:layout_gravity=</span><span class="s">"left"</span>
            <span class="na">android:layout_marginTop=</span><span class="s">"25dp"</span>
            <span class="na">android:paddingLeft=</span><span class="s">"10dp"</span>
            <span class="na">android:text=</span><span class="s">"SSID:"</span>
            <span class="na">android:textSize=</span><span class="s">"18sp"</span> <span class="nt">/&gt;</span>

        <span class="nt">&lt;TextView</span>
            <span class="na">android:id=</span><span class="s">"@+id/textView4"</span>
            <span class="na">android:layout_width=</span><span class="s">"wrap_content"</span>
            <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
            <span class="na">android:textSize=</span><span class="s">"18sp"</span>
            <span class="na">android:text=</span><span class="s">"Current SSID will be here"</span> <span class="nt">/&gt;</span>

        <span class="nt">&lt;TextView</span>
            <span class="na">android:id=</span><span class="s">"@+id/passwordView"</span>
            <span class="na">android:layout_width=</span><span class="s">"wrap_content"</span>
            <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
            <span class="na">android:layout_gravity=</span><span class="s">"left"</span>
            <span class="na">android:layout_marginTop=</span><span class="s">"25dp"</span>
            <span class="na">android:paddingLeft=</span><span class="s">"10dp"</span>
            <span class="na">android:text=</span><span class="s">"Password:"</span>
            <span class="na">android:textSize=</span><span class="s">"18sp"</span> <span class="nt">/&gt;</span>

        <span class="nt">&lt;TextView</span>
            <span class="na">android:id=</span><span class="s">"@+id/textView5"</span>
            <span class="na">android:layout_width=</span><span class="s">"wrap_content"</span>
            <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
            <span class="na">android:textSize=</span><span class="s">"18sp"</span>
            <span class="na">android:text=</span><span class="s">"Current password will be here"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;/LinearLayout&gt;</span>
</code></pre></div></div>
<hr />
<h2 id="set-画面のレイアウト作成">Set 画面のレイアウト作成</h2>

<p>次に、<em>activity_set_screen.xml</em> を記述して、SSIDとパスワードを設定できるレイアウトを決定します。<br />
この画面は、ネットワークの変更に重要な役割をつとめる４つの入力欄から構成されます。<br />
入力欄は、このXMLファイルに設定する方法となっており、テキスト入力欄を選択した際、キーボードが表示されるようにします</p>

<p>このファイルは、layout フォルダに配置されています。<br />
パス:
<em>[Project_Folder]/res/layout/activity_set_screen.xml</em></p>

<h5 id="activity_set_screenxml"><em>activity_set_screen.xml</em></h5>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nt">&lt;LinearLayout</span> <span class="na">xmlns:android=</span><span class="s">"http://schemas.android.com/apk/res/android"</span>
        <span class="na">xmlns:tools=</span><span class="s">"http://schemas.android.com/tools"</span>
        <span class="na">android:layout_width=</span><span class="s">"fill_parent"</span>
        <span class="na">android:layout_height=</span><span class="s">"match_parent"</span>
        <span class="na">android:gravity=</span><span class="s">"center_horizontal"</span>
        <span class="na">android:orientation=</span><span class="s">"vertical"</span>
        <span class="na">tools:context=</span><span class="s">".MainActivity"</span> <span class="nt">&gt;</span>

        <span class="nt">&lt;Button</span>
            <span class="na">android:id=</span><span class="s">"@+id/button1"</span>
            <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
            <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
            <span class="na">android:cacheColorHint=</span><span class="s">"#00000000"</span>
            <span class="na">android:text=</span><span class="s">"Back"</span>
            <span class="na">android:textColor=</span><span class="s">"@android:color/white"</span>
            <span class="na">android:textSize=</span><span class="s">"20sp"</span> <span class="nt">/&gt;</span>

        <span class="nt">&lt;TextView</span>
            <span class="na">android:id=</span><span class="s">"@+id/mastercodeView"</span>
            <span class="na">android:layout_width=</span><span class="s">"wrap_content"</span>
            <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
            <span class="na">android:layout_gravity=</span><span class="s">"left"</span>
            <span class="na">android:layout_marginTop=</span><span class="s">"12dp"</span>
            <span class="na">android:paddingLeft=</span><span class="s">"10dp"</span>
            <span class="na">android:text=</span><span class="s">"Mastercode:"</span>
            <span class="na">android:textSize=</span><span class="s">"18sp"</span> <span class="nt">/&gt;</span>

        <span class="nt">&lt;EditText</span>
            <span class="na">android:id=</span><span class="s">"@+id/editMC"</span>
            <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
            <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
            <span class="na">android:ems=</span><span class="s">"10"</span>
            <span class="na">android:hint=</span><span class="s">"Mastercode"</span>
            <span class="na">android:inputType=</span><span class="s">"text"</span>
            <span class="na">android:textStyle=</span><span class="s">"italic"</span> <span class="nt">/&gt;</span>

        <span class="nt">&lt;TextView</span>
            <span class="na">android:id=</span><span class="s">"@+id/warningView"</span>
            <span class="na">android:layout_width=</span><span class="s">"wrap_content"</span>
            <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
            <span class="na">android:layout_gravity=</span><span class="s">"left"</span>
            <span class="na">android:layout_marginTop=</span><span class="s">"8dp"</span>
            <span class="na">android:paddingLeft=</span><span class="s">"10dp"</span>
            <span class="na">android:text=</span><span class="s">"Warning: We have displayed the Mastercode in this tutorial application to demonstrate how the FlashAir device works. This information is provided for tutorial purposes only. For security reasons, we highly discourage you from publicly displaying your Mastercode."</span>
            <span class="na">android:textSize=</span><span class="s">"12sp"</span>
            <span class="na">android:textStyle=</span><span class="s">"italic"</span> <span class="nt">/&gt;</span>

        <span class="nt">&lt;TextView</span>
            <span class="na">android:id=</span><span class="s">"@+id/SSIDlabelView"</span>
            <span class="na">android:layout_width=</span><span class="s">"wrap_content"</span>
            <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
            <span class="na">android:layout_gravity=</span><span class="s">"left"</span>
            <span class="na">android:layout_marginTop=</span><span class="s">"20dp"</span>
            <span class="na">android:paddingLeft=</span><span class="s">"10dp"</span>
            <span class="na">android:text=</span><span class="s">"SSID:"</span>
            <span class="na">android:textSize=</span><span class="s">"18sp"</span> <span class="nt">/&gt;</span>

        <span class="nt">&lt;EditText</span>
            <span class="na">android:id=</span><span class="s">"@+id/editText1"</span>
            <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
            <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
            <span class="na">android:ems=</span><span class="s">"10"</span>
            <span class="na">android:hint=</span><span class="s">"New SSID"</span>
            <span class="na">android:inputType=</span><span class="s">"text"</span>
            <span class="na">android:textStyle=</span><span class="s">"italic"</span> <span class="nt">&gt;</span>

        <span class="nt">&lt;/EditText&gt;</span>

        <span class="nt">&lt;TextView</span>
            <span class="na">android:id=</span><span class="s">"@+id/passwordView"</span>
            <span class="na">android:layout_width=</span><span class="s">"wrap_content"</span>
            <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
            <span class="na">android:layout_gravity=</span><span class="s">"left"</span>
            <span class="na">android:layout_marginTop=</span><span class="s">"20dp"</span>
            <span class="na">android:paddingLeft=</span><span class="s">"10dp"</span>
            <span class="na">android:text=</span><span class="s">"Password:"</span>
            <span class="na">android:textSize=</span><span class="s">"18sp"</span> <span class="nt">/&gt;</span>

        <span class="nt">&lt;EditText</span>
            <span class="na">android:id=</span><span class="s">"@+id/editText2"</span>
            <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
            <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
            <span class="na">android:ems=</span><span class="s">"10"</span>
            <span class="na">android:hint=</span><span class="s">"New Password"</span>
            <span class="na">android:inputType=</span><span class="s">"textPassword"</span>
            <span class="na">android:textStyle=</span><span class="s">"italic"</span> <span class="nt">/&gt;</span>

         <span class="nt">&lt;EditText</span>
             <span class="na">android:id=</span><span class="s">"@+id/editText3"</span>
             <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
             <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
             <span class="na">android:ems=</span><span class="s">"10"</span>
             <span class="na">android:hint=</span><span class="s">"New Password"</span>
             <span class="na">android:inputType=</span><span class="s">"textPassword"</span>
             <span class="na">android:textStyle=</span><span class="s">"italic"</span> <span class="nt">/&gt;</span>

        <span class="nt">&lt;Button</span>
            <span class="na">android:id=</span><span class="s">"@+id/button2"</span>
            <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
            <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
            <span class="na">android:layout_marginTop=</span><span class="s">"12dp"</span>
            <span class="na">android:cacheColorHint=</span><span class="s">"#00000000"</span>
            <span class="na">android:text=</span><span class="s">"Done"</span>
            <span class="na">android:textColor=</span><span class="s">"@android:color/white"</span>
            <span class="na">android:textSize=</span><span class="s">"20sp"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;/LinearLayout&gt;</span>
</code></pre></div></div>
<hr />
<h2 id="get-画面の作成">Get 画面の作成</h2>

<p>まず、SSIDとパスワードの取得と設定が可能な２つの
<code class="highlighter-rouge">Button</code> を初期化します。<br />
また、SSIDとパスワードの取得も実装します。このアプリケーションの他の部分でも使用します。</p>

<h3 id="初期化">初期化</h3>

<p>メンバ変数の宣言と画面の書式を設定します。 それから、各ボタンの
<code class="highlighter-rouge">onClickListener</code> を設定します。<br />
それぞれ動作が異なるので、２つの
<code class="highlighter-rouge">onClick()</code> 関数を記述します:</p>

<h5 id="mainactivityjava-1"><em>MainActivity.java</em> (1)</h5>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="n">Activity</span> <span class="o">{</span>

        <span class="n">TextView</span> <span class="n">SSID</span><span class="o">;</span>
        <span class="n">TextView</span> <span class="n">password</span><span class="o">;</span>
        <span class="n">Button</span> <span class="n">getButton</span><span class="o">;</span>
        <span class="n">Button</span> <span class="n">setButton</span><span class="o">;</span>

        <span class="nd">@Override</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
            <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_main</span><span class="o">);</span>
            <span class="n">getWindow</span><span class="o">().</span><span class="na">setTitleColor</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">rgb</span><span class="o">(</span><span class="mi">65</span><span class="o">,</span> <span class="mi">183</span><span class="o">,</span> <span class="mi">216</span><span class="o">));</span>
            <span class="n">getButton</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">button1</span><span class="o">);</span>
            <span class="n">setButton</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">button2</span><span class="o">);</span>
            <span class="n">getButton</span><span class="o">.</span><span class="na">getBackground</span><span class="o">().</span><span class="na">setColorFilter</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">rgb</span><span class="o">(</span><span class="mi">65</span><span class="o">,</span> <span class="mi">183</span><span class="o">,</span> <span class="mi">216</span><span class="o">),</span> <span class="n">PorterDuff</span><span class="o">.</span><span class="na">Mode</span><span class="o">.</span><span class="na">SRC_IN</span><span class="o">);</span>
            <span class="n">setButton</span><span class="o">.</span><span class="na">getBackground</span><span class="o">().</span><span class="na">setColorFilter</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">rgb</span><span class="o">(</span><span class="mi">65</span><span class="o">,</span> <span class="mi">183</span><span class="o">,</span> <span class="mi">216</span><span class="o">),</span> <span class="n">PorterDuff</span><span class="o">.</span><span class="na">Mode</span><span class="o">.</span><span class="na">SRC_IN</span><span class="o">);</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">getButton</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
                    <span class="nd">@Override</span>
                    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
                        <span class="c1">// Set button to show current SSID and Password</span>
                        <span class="n">getSSID</span><span class="o">();</span>
                        <span class="n">getPassword</span><span class="o">();</span>
                    <span class="o">}</span>
                <span class="o">});</span>
            <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="s">"ERROR"</span><span class="o">,</span> <span class="s">"ERROR: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">setButton</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
                    <span class="nd">@Override</span>
                    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
                        <span class="c1">// Set button to start new intent to allow new SSID and password input</span>
                        <span class="n">Intent</span> <span class="n">setSSIDPassword</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">getBaseContext</span><span class="o">(),</span> <span class="n">SetScreenActivity</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
                        <span class="n">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">.</span><span class="na">startActivity</span><span class="o">(</span><span class="n">setSSIDPassword</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">});</span>
            <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="s">"ERROR"</span><span class="o">,</span> <span class="s">"ERROR: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>


        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">onCreateOptionsMenu</span><span class="o">(</span><span class="n">Menu</span> <span class="n">menu</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// Inflate the menu; this adds items to the action bar if it is present.</span>
            <span class="n">getMenuInflater</span><span class="o">().</span><span class="na">inflate</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">menu</span><span class="o">.</span><span class="na">main</span><span class="o">,</span> <span class="n">menu</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>
    <p>18-25行目<br />
  <code class="highlighter-rouge">getButton</code> のクリックリスナーを設定しています。<br />
  <code class="highlighter-rouge">Button</code>がクリックされた時、FlashAirから現在のSSIDを取得する関数と、FlashAirから現在のパスワードを取得する関数を呼びます(両方とも実装は後述します)。</p>
  </li>
  <li>
    <p>33-38行目<br />
  <code class="highlighter-rouge">setButton</code> のクリックリスナーを設定しています。 SSIDとパスワードは他の<code class="highlighter-rouge">class</code> と 別の画面を使用して設定するので、このリスナーは単に次の画面を開始するための<code class="highlighter-rouge">Intent</code> を設定しています。 次の画面へ引き継ぐ情報はありませんので、追加で<code class="highlighter-rouge">Bundle</code> データは送りません。</p>
  </li>
</ul>

<h3 id="ssidの取得">SSIDの取得</h3>

<p>上記の関数から呼び出されている
<code class="highlighter-rouge">getSSID()</code> 関数は、FlashAirから現在のSSIDを取得します。 FlashAirのSSIDは最大32文字まで設定可能です。</p>

<p>FlashAirの現在のSSIDを取得するためには、以下のコマンドを使用します:</p>

<ul>
  <li><code class="highlighter-rouge">command.cgi</code> に<code class="highlighter-rouge">op=104</code> を指定します。
    <ul>
      <li>コマンド: <code class="highlighter-rouge">http://flashair/command.cgi?op=104</code></li>
      <li>コマンドが返す情報:<code class="highlighter-rouge">&lt;SSID&gt;</code></li>
    </ul>
  </li>
</ul>

<p>コマンドの実行には前項
<a href="3">Android Tutorial 3: コンテンツのダウンロード</a>までに作成した、
<em>FlashAirRequest.java</em> を使用します。</p>

<h5 id="mainactivityjava-2"><em>MainActivity.java</em> (2)</h5>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getSSID</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">new</span> <span class="n">AsyncTask</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Void</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;(){</span>
                <span class="nd">@Override</span>
                <span class="kd">protected</span> <span class="n">String</span> <span class="nf">doInBackground</span><span class="o">(</span><span class="n">String</span><span class="o">...</span> <span class="n">params</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="n">FlashAirRequest</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">params</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
                <span class="o">}</span>
                <span class="nd">@Override</span>
                <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onPostExecute</span><span class="o">(</span><span class="n">String</span> <span class="n">currentSSID</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">SSID</span> <span class="o">=</span> <span class="o">(</span><span class="n">TextView</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">textView4</span><span class="o">);</span>
                    <span class="n">SSID</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">currentSSID</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}.</span><span class="na">execute</span><span class="o">(</span><span class="s">"http://flashair/command.cgi?op=104"</span><span class="o">);</span>
        <span class="o">}</span>
</code></pre></div></div>
<h3 id="パスワードの取得">パスワードの取得</h3>

<p>前述した
<code class="highlighter-rouge">onClick()</code> 関数から呼び出されている
<code class="highlighter-rouge">getPassword()</code> は、FlashAirから現在のパスワードを取得します。
FlashAirのパスワードは最大64文字まで設定可能です。</p>

<p>FlashAirの現在のパスワードを取得するためには、以下のコマンドを使用します:</p>

<ul>
  <li><code class="highlighter-rouge">command.cgi</code> に<code class="highlighter-rouge">op=105</code> を指定します。
    <ul>
      <li>コマンド: <code class="highlighter-rouge">http://flashair/command.cgi?op=105</code></li>
      <li>コマンドが返す情報: <code class="highlighter-rouge">&lt;networkPassword&gt;</code></li>
    </ul>
  </li>
</ul>

<p>コマンドの実行には前項
<a href="3">Android Tutorial 3: コンテンツのダウンロード</a>までに作成した、
<em>FlashAirRequest.java</em> を使用します。</p>

<h5 id="mainactivityjava-3"><em>MainActivity.java</em> (3)</h5>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getPassword</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">new</span> <span class="n">AsyncTask</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Void</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;(){</span>
                <span class="nd">@Override</span>
                <span class="kd">protected</span> <span class="n">String</span> <span class="nf">doInBackground</span><span class="o">(</span><span class="n">String</span><span class="o">...</span> <span class="n">params</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="n">FlashAirRequest</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">params</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
                <span class="o">}</span>
                <span class="nd">@Override</span>
                <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onPostExecute</span><span class="o">(</span><span class="n">String</span> <span class="n">currentPassword</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">password</span> <span class="o">=</span> <span class="o">(</span><span class="n">TextView</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">textView5</span><span class="o">);</span>
                    <span class="n">password</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">currentPassword</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}.</span><span class="na">execute</span><span class="o">(</span><span class="s">"http://flashair/command.cgi?op=105"</span><span class="o">);</span>
        <span class="o">}</span>
</code></pre></div></div>
<p>では、
<code class="highlighter-rouge">setButton</code> がクリックされた後の一連の処理を行う
<code class="highlighter-rouge">SetScreenActivity</code> を、記述します。</p>

<hr />
<h2 id="設定画面の作成">設定画面の作成</h2>

<p><span class="badge label-red">注意:</span>
MASTERCODEは、FlashAirの新しいSSIDやパスワードを設定する際に使用します。
MASTERCODEを確認するには、PCなどにFlashAirを挿入し、”/SD_WLAN/”
フォルダに保存されているCONFIGファイルを、お手持ちのテキストエディタなどで開きます（FlashAirの初期設定を終えていない場合は確認ができませんので、先に済ませるようにしてください）。<br />
また、このフォルダは隠しフォルダとなっていますので、隠しフォルダを扱う事が出来るツールを使いましょう。<br />
Mastercodeは、このファイルに保存されています:</p>

<p><img src="/assets/images/tutorials/ios_tutorial_06_5.png" alt="This image shows the Mastercode in the config file" class="d-block" /></p>

<p>Mastercode を入手すれば、
<a href="/docs/api/config.cgi">config.cgi</a> が使用できるようになります。</p>

<h3 id="初期化-1">初期化</h3>

<p>FlashAirに新しい SSID とパスワードを送るためのボタンを用意します。ラベルは ‘Done’ とし、全ての入力欄への入力が終わるまでは無効にします。</p>

<p>新しい画面ではユーザーの入力が必要なので、 ユーザーが入力ための
<code class="highlighter-rouge">EditText</code> と 入力欄を監視するための
<code class="highlighter-rouge">TextWatcher</code> を初期化します。 全部で４つの入力欄が必要であり、 Mastercode用、新しいSSID用, 新しいパスワード用、
新しいパスワードの確認用(ミスを避けるため)です。
<code class="highlighter-rouge">TextWatcher class</code> をオーバーライドし
<code class="highlighter-rouge">fieldWatcher</code> をカスタマイズします。
<code class="highlighter-rouge">fieldWatcher</code> は全ての入力欄の入力内容をチェックし、その後 ‘Done’ ボタンを有効にします。</p>

<h5 id="setscreenactivityjava-1"><em>SetScreenActivity.java</em> (1)</h5>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">SetScreenActivity</span> <span class="kd">extends</span> <span class="n">Activity</span> <span class="o">{</span>

        <span class="n">EditText</span> <span class="n">mastercodeField</span><span class="o">;</span>
        <span class="n">EditText</span> <span class="n">SSIDfield</span><span class="o">;</span>
        <span class="n">EditText</span> <span class="n">passwordField</span><span class="o">;</span>
        <span class="n">EditText</span> <span class="n">passwordField2</span><span class="o">;</span>
        <span class="n">Button</span> <span class="n">backButton</span><span class="o">;</span>
        <span class="n">Button</span> <span class="n">doneButton</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">newSSID</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">newPassword</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">newPassword2</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">mastercode</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="n">Boolean</span> <span class="n">SSIDset</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
        <span class="n">Boolean</span> <span class="n">passwordSet</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
        <span class="n">TextWatcher</span> <span class="n">fieldWatcher</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TextWatcher</span><span class="o">(){</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">afterTextChanged</span><span class="o">(</span><span class="n">Editable</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span><span class="o">(</span><span class="n">mastercodeField</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">().</span><span class="na">isEmpty</span><span class="o">()</span> 
                   <span class="o">||</span> <span class="n">SSIDfield</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">().</span><span class="na">isEmpty</span><span class="o">()</span>
                   <span class="o">||</span> <span class="n">passwordField</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">().</span><span class="na">isEmpty</span><span class="o">()</span>
                   <span class="o">||</span> <span class="n">passwordField2</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">().</span><span class="na">isEmpty</span><span class="o">()</span> <span class="o">)</span> <span class="o">{</span>
                    <span class="n">doneButton</span><span class="o">.</span><span class="na">setEnabled</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
                <span class="o">}</span>
                <span class="k">else</span> <span class="o">{</span>
                    <span class="n">doneButton</span><span class="o">.</span><span class="na">setEnabled</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">beforeTextChanged</span><span class="o">(</span><span class="n">CharSequence</span> <span class="n">cs</span><span class="o">,</span> <span class="kt">int</span> <span class="n">start</span><span class="o">,</span> <span class="kt">int</span> <span class="n">count</span><span class="o">,</span> <span class="kt">int</span> <span class="n">after</span><span class="o">)</span> <span class="o">{</span>
                <span class="c1">// Do nothing</span>
            <span class="o">}</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onTextChanged</span><span class="o">(</span><span class="n">CharSequence</span> <span class="n">cs</span><span class="o">,</span> <span class="kt">int</span> <span class="n">start</span><span class="o">,</span> <span class="kt">int</span> <span class="n">before</span><span class="o">,</span> <span class="kt">int</span> <span class="n">count</span><span class="o">)</span> <span class="o">{</span>
                <span class="c1">// Do nothing</span>
            <span class="o">}</span>
        <span class="o">};</span>
</code></pre></div></div>
<ul>
  <li>17-27行目<br />
   入力欄で変更があるたび、<code class="highlighter-rouge">fieldWatcher</code> が 全ての入力欄に何かしらの入力があるかどうかをチェックします。<br />
   このチェックは<code class="highlighter-rouge">doneButton</code> ボタンを制御するためのものです。</li>
</ul>

<p>各フィールドに何かしらの入力があると判断した場合、
<code class="highlighter-rouge">doneButton</code> は有効になります:</p>

<p><img src="/assets/images/tutorials/android_tutorial_06_5.png" alt="This image shows the set screen with enabled Done button" class="d-block" /></p>

<p>ユーザーがいずれかの入力欄をクリアした場合は、
<code class="highlighter-rouge">doneButton</code> は無効になります:</p>

<p><img src="/assets/images/tutorials/android_tutorial_06_4.png" alt="This image shows the set screen with disabled Done button" class="d-block" /></p>

<p>全ての
<code class="highlighter-rouge">Activity</code>を初期化する
<code class="highlighter-rouge">onCreate(Bundle savedInstanceState)</code> 関数をオーバーライドします。
この関数は、画面の書式、全ての .xml 要素の識別、そして
<code class="highlighter-rouge">class MainActivity</code> から渡された
<code class="highlighter-rouge">Intent</code> を設定します。
また、上記で記した
<code class="highlighter-rouge">fieldWatcher</code> がそれぞれの
<code class="highlighter-rouge">EditText</code> を監視するよう設定します。</p>

<h5 id="setscreenactivityjava-2"><em>SetScreenActivity.java</em> (2)</h5>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="nd">@Override</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
            <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_set_screen</span><span class="o">);</span>
            <span class="n">getWindow</span><span class="o">().</span><span class="na">setTitleColor</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">rgb</span><span class="o">(</span><span class="mi">65</span><span class="o">,</span> <span class="mi">183</span><span class="o">,</span> <span class="mi">216</span><span class="o">));</span>
            <span class="n">backButton</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">button1</span><span class="o">);</span>
            <span class="n">doneButton</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">button2</span><span class="o">);</span>
            <span class="n">backButton</span><span class="o">.</span><span class="na">getBackground</span><span class="o">().</span><span class="na">setColorFilter</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">rgb</span><span class="o">(</span><span class="mi">65</span><span class="o">,</span> <span class="mi">183</span><span class="o">,</span> <span class="mi">216</span><span class="o">),</span> <span class="n">PorterDuff</span><span class="o">.</span><span class="na">Mode</span><span class="o">.</span><span class="na">SRC_IN</span><span class="o">);</span>
            <span class="n">doneButton</span><span class="o">.</span><span class="na">getBackground</span><span class="o">().</span><span class="na">setColorFilter</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">rgb</span><span class="o">(</span><span class="mi">65</span><span class="o">,</span> <span class="mi">183</span><span class="o">,</span> <span class="mi">216</span><span class="o">),</span> <span class="n">PorterDuff</span><span class="o">.</span><span class="na">Mode</span><span class="o">.</span><span class="na">SRC_IN</span><span class="o">);</span>
            <span class="n">doneButton</span><span class="o">.</span><span class="na">setEnabled</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span> <span class="c1">// Disable until text fields have been filled</span>
            <span class="n">mastercodeField</span> <span class="o">=</span> <span class="o">(</span><span class="n">EditText</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">editMC</span><span class="o">);</span>
            <span class="n">SSIDfield</span> <span class="o">=</span> <span class="o">(</span><span class="n">EditText</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">editText1</span><span class="o">);</span>
            <span class="n">passwordField</span> <span class="o">=</span> <span class="o">(</span><span class="n">EditText</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">editText2</span><span class="o">);</span>
            <span class="n">passwordField2</span> <span class="o">=</span> <span class="o">(</span><span class="n">EditText</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">editText3</span><span class="o">);</span>
            <span class="n">mastercodeField</span><span class="o">.</span><span class="na">setHintTextColor</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">rgb</span><span class="o">(</span><span class="mi">65</span><span class="o">,</span> <span class="mi">183</span><span class="o">,</span> <span class="mi">216</span><span class="o">));</span>
            <span class="n">SSIDfield</span><span class="o">.</span><span class="na">setHintTextColor</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">rgb</span><span class="o">(</span><span class="mi">65</span><span class="o">,</span> <span class="mi">183</span><span class="o">,</span> <span class="mi">216</span><span class="o">));</span>
            <span class="n">passwordField</span><span class="o">.</span><span class="na">setHintTextColor</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">rgb</span><span class="o">(</span><span class="mi">65</span><span class="o">,</span> <span class="mi">183</span><span class="o">,</span> <span class="mi">216</span><span class="o">));</span>
            <span class="n">passwordField2</span><span class="o">.</span><span class="na">setHintTextColor</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">rgb</span><span class="o">(</span><span class="mi">65</span><span class="o">,</span> <span class="mi">183</span><span class="o">,</span> <span class="mi">216</span><span class="o">));</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">getIntent</span><span class="o">();</span>
                <span class="n">backButton</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
                    <span class="nd">@Override</span>
                    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">SetScreenActivity</span><span class="o">.</span><span class="na">this</span><span class="o">.</span><span class="na">finish</span><span class="o">();</span>
                    <span class="o">}</span>
                <span class="o">});</span>
                <span class="n">doneButton</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
                    <span class="nd">@Override</span>
                    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">getInput</span><span class="o">();</span>
                        <span class="n">setNewSSIDPassword</span><span class="o">();</span>
                    <span class="o">}</span>
                <span class="o">});</span>
                <span class="n">mastercodeField</span><span class="o">.</span><span class="na">addTextChangedListener</span><span class="o">(</span><span class="n">fieldWatcher</span><span class="o">);</span>
                <span class="n">SSIDfield</span><span class="o">.</span><span class="na">addTextChangedListener</span><span class="o">(</span><span class="n">fieldWatcher</span><span class="o">);</span>
                <span class="n">passwordField</span><span class="o">.</span><span class="na">addTextChangedListener</span><span class="o">(</span><span class="n">fieldWatcher</span><span class="o">);</span>
                <span class="n">passwordField2</span><span class="o">.</span><span class="na">addTextChangedListener</span><span class="o">(</span><span class="n">fieldWatcher</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="s">"ERROR"</span><span class="o">,</span> <span class="s">"ERROR: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>


        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">onCreateOptionsMenu</span><span class="o">(</span><span class="n">Menu</span> <span class="n">menu</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// Inflate the menu; this adds items to the action bar if it is present.</span>
            <span class="n">getMenuInflater</span><span class="o">().</span><span class="na">inflate</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">menu</span><span class="o">.</span><span class="na">set_screen</span><span class="o">,</span> <span class="n">menu</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>
    <p>10行目<br />
  <code class="highlighter-rouge">doneButton</code> はインスタンス化するとすぐに無効になります。<br />ユーザーは全ての入力が終わるまで、FlashAirにCGIコマンドを送信することができなくなります。これにより、CGIコマンドを実行した際のエラーを回避することができます。</p>
  </li>
  <li>
    <p>11-18行目<br />
   各入力欄にヒントを設定しています(ユーザーが入力を開始するまで表示します)。</p>
  </li>
  <li>
    <p>34-37行目<br />
   各入力欄に<code class="highlighter-rouge">fieldWatcher</code>を追加しています。これによりユーザーが入力または削除をした際、処理を行えるようになります。</p>
  </li>
</ul>

<h3 id="入力値の取得">入力値の取得</h3>

<p>次の関数は、ユーザーの入力値を取得します。 この関数は
<code class="highlighter-rouge">doneButton</code>の
<code class="highlighter-rouge">onClick()</code> 関数に呼ばれます。
<code class="highlighter-rouge">fieldWatcher</code> が４つの入力欄全ての入力を見つけたときにのみ、値を取得し格納します。</p>

<h5 id="setscreenactivityjava-3"><em>SetScreenActivity.java</em> (3)</h5>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getInput</span><span class="o">()</span> <span class="o">{</span>
                <span class="n">mastercode</span> <span class="o">=</span> <span class="n">mastercodeField</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">();</span>
                <span class="n">newSSID</span> <span class="o">=</span> <span class="n">SSIDfield</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">();</span>
                <span class="n">newPassword</span> <span class="o">=</span> <span class="n">passwordField</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">();</span>
                <span class="n">newPassword2</span> <span class="o">=</span> <span class="n">passwordField2</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">();</span>
        <span class="o">}</span>
</code></pre></div></div>
<h3 id="確認用パスワードの一致">確認用パスワードの一致</h3>

<p>新しいパスワードを入力する際の入力ミスを避けるために、このアプリケーションは２回パスワードを入力する必要があり、２つのパスワードが一致するかどうかを確認します。次の関数は、２つのパスワードが一致するかどうかをチェックし、一致する場合はCGIコマンドを送信しても安全であるということを示しています。</p>

<h5 id="setscreenactivityjava-4"><em>SetScreenActivity.java</em> (4)</h5>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="kd">public</span> <span class="n">Boolean</span> <span class="nf">passwordConfirmed</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">if</span><span class="o">(</span><span class="n">newPassword</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">newPassword2</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
</code></pre></div></div>
<p>もし
<code class="highlighter-rouge">passwordConfirmed()</code> が
<code class="highlighter-rouge">false</code>を返した場合は、 後述する関数 (
<code class="highlighter-rouge">setNewSSIDPassword()</code>) でパスワードをクリアし (
<code class="highlighter-rouge">doneButton</code> が無効になる)、 パスワードが異なっていることを指し示す
<code class="highlighter-rouge">Toast</code>を表示します:</p>

<p><img src="/assets/images/tutorials/android_tutorial_06_8.png" alt="This image shows the set screen with the password mismatch toast" class="d-block" /></p>

<h3 id="ssidとパスワードの設定">SSIDとパスワードの設定</h3>

<p>次の機能は、FlashAirにCGIコマンドを送信し、その応答を処理します。<br />
コマンドを送信する前に、パスワードが正しく入力されていることを保証するため、上記の
<code class="highlighter-rouge">passwordConfirmed()</code> を呼び出しています。</p>

<p>SSIDを設定するためには、以下のコマンドを使用します:</p>

<ul>
  <li><code class="highlighter-rouge">config.cgi</code> に Mastercode と 新しいSSIDを指定します。
    <ul>
      <li>Mastercode = 0123456789AB、SSID = flashair である場合は、このようになります:<br />
  <code class="highlighter-rouge">http://flashair/config.cgi?MASTERCODE=0123456789AB&amp;APPSSID=flashair</code></li>
      <li>コマンドが返す情報:
        <ul>
          <li><code class="highlighter-rouge">SUCCESS</code> SSIDの変更に成功</li>
          <li><code class="highlighter-rouge">ERROR</code> SSIDの変更に失敗</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>SSIDをパスワードを設定するためには、以下のコマンドを使用します:</p>

<ul>
  <li><code class="highlighter-rouge">config.cgi</code> に Mastercode と 新しいパスワードを指定します
    <ul>
      <li>Mastercode = 0123456789AB、パスワード = 12345678 である場合は、このようになります:<br />
  <code class="highlighter-rouge">http://flashair/config.cgi?MASTERCODE=0123456789AB&amp;APPNETWORKKEY=12345678</code></li>
      <li>コマンドが返す情報:
        <ul>
          <li><code class="highlighter-rouge">SUCCESS</code> パスワードの変更に成功</li>
          <li><code class="highlighter-rouge">ERROR</code> パスワードの変更に失敗</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>結合して同時に指定する場合はこのようになります:<br />
<code class="highlighter-rouge">http://flashair/config.cgi?MASTERCODE=0123456789AB&amp;APPNETWORKKEY=12345678&amp;APPSSID=flashair</code></p>

<p>新しいSSIDは、1 ～ 32 文字でなければならず、パスワードは、8 ～ 64 文字の間でなければなりません。 これらの条件のいずれかに反した場合は、コマンドCGIは
<code class="highlighter-rouge">ERROR</code> を返します。</p>

<p>コマンドの実行には前項
<a href="3">Android Tutorial 3: コンテンツのダウンロード</a>までに作成した、
<em>FlashAirRequest.java</em> を使用します。</p>

<h5 id="setscreenactivityjava-5"><em>SetScreenActivity.java</em> (5)</h5>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setNewSSIDPassword</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">passwordConfirmed</span><span class="o">())</span> <span class="o">{</span>

            <span class="c1">// If passwords match, do HTTP command, catch and display if command fails</span>
            <span class="k">new</span> <span class="n">AsyncTask</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Void</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;(){</span>
                <span class="nd">@Override</span>
                <span class="kd">protected</span> <span class="n">String</span> <span class="nf">doInBackground</span><span class="o">(</span><span class="n">String</span><span class="o">...</span> <span class="n">params</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="n">FlashAirRequest</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">params</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
                <span class="o">}</span>
                <span class="nd">@Override</span>
                <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onPostExecute</span><span class="o">(</span><span class="n">String</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">if</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">(</span><span class="n">Locale</span><span class="o">.</span><span class="na">getDefault</span><span class="o">()).</span><span class="na">equals</span><span class="o">(</span><span class="s">"SUCCESS"</span><span class="o">))</span> <span class="o">{</span>
                        <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">SetScreenActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="s">"Remember to reconnect to your FlashAir device using the new SSID and password!"</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
                        <span class="n">SetScreenActivity</span><span class="o">.</span><span class="na">this</span><span class="o">.</span><span class="na">finish</span><span class="o">();</span> <span class="c1">// Go back to Get screen</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}.</span><span class="na">execute</span><span class="o">(</span><span class="s">"http://flashair/config.cgi?MASTERCODE="</span> <span class="o">+</span> <span class="n">mastercode</span> <span class="o">+</span> <span class="s">"&amp;APPNETWORKKEY="</span> <span class="o">+</span> <span class="n">newPassword</span> <span class="o">+</span> <span class="s">"&amp;APPSSID="</span> <span class="o">+</span> <span class="n">newSSID</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="c1">// If passwords don't match, display toast</span>
            <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"Password mismatch!"</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_SHORT</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
            <span class="n">passwordField</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
            <span class="n">passwordField2</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>
    <p>13行目<br />
  <code class="highlighter-rouge">Toast</code> を表示し、FlashAir に再接続する必要がある旨を伝えます。 元の画面（古いSSIDとパスワードデータを含む）に戻っても<code class="highlighter-rouge">Toast</code>はまだしばらくの間表示されます:</p>
  </li>
  <li>
    <p>14行目<br />
  現在の<code class="highlighter-rouge">Activity</code> を終了し、最初の画面 (<code class="highlighter-rouge">class MainActivity</code>) へ戻り、再度新しいSSIDとパスワードを設定します。<br />
  SSIDとパスワードの変更に成功した場合は、AndroidはFlashAirのSSIDとパスワードが変わってしまっているので、FlashAirとの接続は切れます。</p>
  </li>
</ul>

<hr />
<h2 id="実行結果">実行結果</h2>

<p>Toastはこのように表示されます。</p>

<p><img src="/assets/images/tutorials/android_tutorial_06_6.png" alt="This image shows the get screen with the toast" class="d-block" /></p>

<p>新しいSSIDとパスワードに変更しFlashAirに再接続した後、”Get”をタップすると、新たに変更されたSSIDとネットワークパスワードを取得します:</p>

<p><img src="/assets/images/tutorials/android_tutorial_06_7.png" alt="This image shows the get screen with the toast" class="d-block" /></p>

<hr />
<h2 id="サンプルコード">サンプルコード</h2>
<p><a href="/files/samplecode/android/android_tutorial_06.zip" class="btn btn-primary">android_tutorial_06.zip</a> (532KB)</p>

<p>このサイトのサンプルコードは<a href="/docs/license">二条項BSDライセンス</a>で提供されています。</p>



          
        </div>
      </div>
    </div>
  </div>

</body>
</html>
